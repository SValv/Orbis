---
title: "Orbis Astea
date: "Version from: `r format(Sys.Date(),'%d.%m.%Y')`"
author: "DM-App version: 3.6"
site: bookdown::bookdown_site
favicon: "roundIco.ico"
---

# (PART) Orbis Astea {.unnumbered}

# introduction

![](Pictures/Team/OrbisAsteaWritingT.png)

## What is Orbis Astea?

Orbis Astea is an open source pen & paper roleplaying game developed by a German speaking [Team](#Team). Currently it is available for free [download](DMAppDownload) via this website. The idea of Orbis Astea is to guarantee a fluid and easy gameplay for players and DM by keeping rules and procedures as automated and as simple as possible, while providing a comprehensive range of game facets/functionality. For players in particular, Orbis Astea is an easily accessible and quick to learn system (getting a player ready to play takes 15 minutes to an hour). Also, Orbis Astea has the advantage that actions, such as fighting, creating a restful resting place or driving vehicles, can be done very quickly. Orbis Astea also offers many additional features, such as a variety of directly playable yet slightly different profiles for NPCs, automatic merchant inventories, anonymous character sheets and and and - it's best to just try it out. Orbis Astea requires a computer on which the DM runs the program.

Orbis Astea offers elements of both high and low fantasy settings, but has no active magic system. The system itself works with any worldbuilding that has similar circumstances - that is, is somewhat closer to reality (XXXX YOU CAN APPLY IT TO OTHER OWN WORLDS; AS LONG AS IT IS CLOSER TO REALITY, a highly customizable system that can be adapted in various ways). However, of course, the system works best with the lore of Orbis Astea - since many items and some mechanics are adapted to that world.

## Overview of the world

It is the year 426 since the founding of the Empire. The Great War between the Rah Kari and the Empire was 5 years ago, since then the two great empires are in a cold war with each other. Again and again there are conflicts between the troops of the Rah Kari and the Empire - as well as many proxy wars.

# The map

Here you can see the map of Orbis Astea. All maps in Orbis Astea are oriented to the west, which means that the south is on the left, the north on the right and the east on the bottom.

``{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F, warning = F,message = F)
library(leaflet)
library(leafem)
library(readxl)
library(sp)
library(leaflet.extras)
library(htmltools)
library(tidyverse)
library(zip)
library(reactable)

path=str_remove(getwd(), "###Orbis")

print(getwd())

source(paste0(path, "Readme Help Tools/Codes/KeyIndexCreate.R"))

file.copy(paste0(path, "Container/",c("CCSheetBlank.xlsx", "CCrand.xlsx", "Getting Started with Orbis.pdf")),
          "DownloadContainer",overwrite =T)


from <- paste0(path, "Container/Data")
to <- "OrbisGame/Container/Data"
file.copy(list.files(from, full.names = TRUE),
          to,
          recursive = TRUE,overwrite =T)

from <- paste0(path, "Container/Data")
to <- "container/data"
file.copy(list.files(from, full.names = TRUE),
          to,
          recursive = TRUE,overwrite =T)

zip(
  "DownloadContainer/OrbisAstea.zip",
  c("../Orbis Launcher",
    "OrbisGame"),
  recurse = TRUE,
  compression_level = 9,
  include_directories = TRUE,
  root = ".",
  mode = c("cherry-pick")
)

from <- "DownloadContainer"
to <- "docs/DownloadContainer"
file.copy(list.files(from, full.names = TRUE),
          to,
          recursive = TRUE,overwrite =T)

file.copy("Pictures/Maps/OrbisAstea.jpg",
          "docs",
          recursive = TRUE,overwrite =T)

overallThemeReactable=reactableTheme(backgroundColor = "transparent", borderColor = "black",
                                     stripedColor = "#FDF6E3", headerStyle=list(backgroundColor="#FDF6E3"))

```

``{r read Data leaflet, include=FALSE}
leafletpath="BookdownData/LeafletData.xlsx"

dfTotal=read_excel(leafletpath, sheet= "LandmarksData")
options(scipen=999)

dfCities=dfTotal %>% filter(Icons=="Big city")
dfCity= dfTotal %>% filter(Icons=="City")
dfSmall= dfTotal %>% filter(Icons=="Farm" | Icons == "Village")
dfMilitia=dfTotal %>% filter(Icons=="Militia town" | Icons == "Outpost")
dfNature=dfTotal %>% filter(Icons=="Landmark" | Icons == "Nature" | Icons == "Battle")
dfRuins= dfTotal %>% filter(Icons=="Ruin")

```

``{r PolitPolygons, echo=FALSE}
colvec=c("red","#CE5500","#9F13A8","#3B2B06","black")

KaisKernPoly=Polygon(cbind(c(20.4, 23, 26.8, 29.5, 33.8, 33.7,33.4, 35, 37,
                             37.6, 39.5,36.6, 38, 37.3, 39.8, 40.9,40.9,28,27.3,30,28.34, 25.4, 23),
                            c(20.8, 24, 25.2, 25.5, 24.8, 23.5, 21.5, 20,
                              18.5, 17.4, 15.2, 13.75, 12,11, 8.6, 6.1,0,0,3.3,4.4,7.8,8.4,11.3)
))
KaisKernPolygons=Polygons(list(KaisKernPoly), "Empire")


KaisBesatzPoly=Polygon(cbind(c(27.9,15,13.5,10.7,11.7,14,14.6,16.6,20.4,21.2, 23.9,24, 26.4,27.2),
                            c(0,0,4,6.2,7.7,8.46,9,10.6,9,7,4.5,3,2.6, 2.76)
))
KaisPopulationPolygons=Polygons(list(KaisPopulationPoly), "KaiserreichPopulation")


RahKariPoly=Polygon(cbind(c(0,4,9.6,12.4,13.6,16,15.3,15.5,14.3,12.3,11,8.55,6.24,3.8,3,1,0),
                            c(22,24.3,23,21.1,21,17.85,16.5, 15.4,13.2,11.8,11.5,9,7.55,7.35,10.7,12.55,13.6)
))
RahKariPolygons=Polygons(list(RahKariPoly), "RahKari")

SilvaPoly=Polygon(cbind(c(20.6,23.12,25.23,28.25,30.24,27.4,25,23.5,21.5),
                            c(9.1,10.75,8.4,7.7,4.5,3.5,5.4,5.3,6.9)
))
SilvaPolygons=Polygons(list(SilvaPoly), "SilvaNacia")

VulkanPoly=Polygon(cbind(c(15.8,13.35,11.7,13.22,15,17.4,17.6),
                            c(22.8,23.4,25,26.8,26.85,24.95,23.6)
))
VolcanoPolygons=Polygons(list(VolcanoPoly), "VolcanoDwarfs")


PolitPolygons = SpatialPolygons(list(KaisKernPolygons,KaisBesatzPolygons,RahKariPolygons,SilvaPolygons,VulkanPolygons),1:5)

PolitPolygonsData=read_excel(leafletpath, sheet = "GreatRealmData")

PolitLabels= sprintf(
  "<strong>%s</strong><br/>ca %i people <br>under %s",
  PolitPolygonsData$name, PolitPolygonsData$population, PolitPolygonsData$ruler
) %>% lapply(htmltools::HTML)
```

``{r RegionPolygons, echo=F}


dfRegionPolyValues=read_excel(leafletpath, sheet="RegionsPolygons")

BorderPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LongBorder),na.omit(dfRegionPolyValues$LatBorder)))
BorderlandPolygons=Polygons(list(borderlandPoly), "borderland")

BermaPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LongBerma),na.omit(dfRegionPolyValues$LatBerma)))
BermaPolygons=Polygons(list(BermaPoly), "BermaValley")

IronPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LongIronRed),na.omit(dfRegionPolyValues$LatIronRed)))
IronPolygons=Polygons(list(IronPoly), "IronRed Desert")

WormfallPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LatWormfall),na.omit(dfRegionPolyValues$LatWormfall)))
#WormfallHolePoly=Polygon(cbind(na.omit(dfRegionPolyValues$LatIronRed),na.omit(dfRegionPolyValues$LatIronRed)),hole=T)
WormfallPolygons=Polygons(list(WormfallPoly), "Wormfall")

EidTPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LongEidT),na.omit(dfRegionPolyValues$LatEidT)))
EidTPolygons=Polygons(list(EidTPoly), "Eid Tanis")

SudEldriaPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LatSouthEldria),na.omit(dfRegionPolyValues$LatSouthEldria)))
SudEldriaPolygons=Polygons(list(SudEldriaPoly), "SouthEldria")

AppoPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LongAppothis),na.omit(dfRegionPolyValues$LatAppothis)))
AppoPolygons=Polygons(list(AppoPoly), "Appothis")

NorthEldriaPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LongNorthEldria),na.omit(dfRegionPolyValues$LatNorthEldria)))
NorthEldriaPolygons=Polygons(list(NorthEldriaPoly), "NorthEldria")

NorsPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LongNors),na.omit(dfRegionPolyValues$LatNors)))
NorsPolygons=Polygons(list(NorsPoly), "Nors")

IcelandPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LatEis),na.omit(dfRegionPolyValues$LatEis)))
IcelandPolygons=Polygons(list(icelandPoly), "iceland")

Fog GrovePoly=Polygon(cbind(na.omit(dfRegionPolyValues$LongFogHain),na.omit(dfRegionPolyValues$LatFogHain)))
MistyHainPolygons=Polygons(list(MistyHainPoly), "MistyHain")

YondallaPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LongYondalla),na.omit(dfRegionPolyValues$LatYondalla)))
YondallaPolygons=Polygons(list(YondallaPoly), "Yondalla")

SilvaPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LongSilvaNacia),na.omit(dfRegionPolyValues$LatSilvaNacia)))
SilvaPolygons=Polygons(list(SilvaPoly), "Silva Nacia")

SkyEastPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LatSkyEast),na.omit(dfRegionPolyValues$LatSkyEast)))
SkyEastPolygons=Polygons(list(SkyEastPoly), "EastSkyPoints")

EidRahKahPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LongEidRahKari),na.omit(dfRegionPolyValues$LatEidRahKari))
EidRahKahPolygons=Polygons(list(EidRahKahPoly), "Eid' Rah Kahri")

HazePointsPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LongHazePoints),na.omit(dfRegionPolyValues$LatHazePoints)))
HazePointsPolygons=Polygons(list(HazePointsPoly), "HazePoints")

GoblinsPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LongGoblinLand),na.omit(dfRegionPolyValues$LatGoblinLand)))
GoblinsPolygons=Polygons(list(GoblinsPoly), "Goblinland")

AtumpetPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LongAtumpet),na.omit(dfRegionPolyValues$LatAtumpet)))
AtumpetPolygons=Polygons(list(AtumpetPoly), "Atumpet")

GrayPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LongGrayOrd),na.omit(dfRegionPolyValues$LatGrayOrd)))
GrayPolygons=Polygons(list(GrayPoly), "Gray Wasteland")

UpperRealmPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LatOber),na.omit(dfRegionPolyValues$LatOber)))
UpperRealmPolygons=Polygons(list(UpperRealmPoly), "UpperReik")

NafPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LongNaf),na.omit(dfRegionPolyValues$LatNaf)))
NafPolygons=Polygons(list(NafPoly), "Nafta enclave")

HeartPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LongHeartland),na.omit(dfRegionPolyValues$LatHeartland)))
HeartPolygons=Polygons(list(HeartPoly), "Heartland")

SkyNorthPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LongHimNorth),na.omit(dfRegionPolyValues$LatHimNorth)))
SkyNorthPolygons=Polygons(list(SkyNorthPoly), "North Sky Mountains")


BoneFieldPoly=Polygon(cbind(na.omit(dfRegionPolyValues$LongKnField),na.omit(dfRegionPolyValues$LatKnField)))
BoneFieldPolygons=Polygons(list(BoneFieldPoly), "BoneFieldGorge")

inputListRegions=list(BorderlandPolygons,BermaPolygons,IronPolygons,WormfallPolygons,OathTPolygons,SudEldriaPolygons,AppoPolygons,NorthEldriaPolygons,NorsPolygons,IcelandPolygons,Mist GrovePolygons,YondallaPolygons,SilvaPolygons,SkyEastPolygons,EidRahKahPolygons,HazePointsPolygons,GoblinsPolygons, AtumpetPolygons,GreyPolygons, UpperAreaPolygons,NafPolygons,HeartPolygons,SkyNorthPolygons,BoneFieldPolygons)

RegionPolygons=SpatialPolygons(inputListRegions,1:length(inputListRegions))

RegionPolygonsData=read_excel(leafletpath, sheet="DataRegionsInfo")

RegionsLabels= sprintf(
  "<strong>%s</strong><br/>Capital: %s<br>Ruler: %s<br>Population density: %s",
  RegionPolygonsData$name, RegionPolygonsData$capital, RegionPolygonsData$ruler, RegionPolygonsData$populationDensity
) %>% lapply(htmltools::HTML)


EconLabels= sprintf(
  "<strong>%s</strong><br/>Demand: %s<br>Supply: %s<br>Economic strength: %s",
  RegionPolygonsData$Name, RegionPolygonsData$`Goods in Demand`,RegionPolygonsData$`Goods in Abundance`,RegionPolygonsData$`Economic Force`
) %>% lapply(htmltools::HTML)

ReliLabels= sprintf(
  "<strong>%s</strong><br>Dominant religion: %s<br>All Gods: %i<br>Teachings of Darcy: %i<br>Followers of Rah Kah: %i<br>Other: %i",
  RegionPolygonsData$Name,RegionPolygonsData$`Dominant Religion`, RegionPolygonsData$AllGodPerc, RegionPolygonsData$DarcyPerc, RegionPolygonsData$RahPerc, RegionPolygonsData$OtherPerc
) %>% lapply(htmltools::HTML)


givecols=function(x,ausvec ,colorvec ){
  vec=c()
  for (i in x){
    for (j in 1:length(ausvec)){
     if(i==outvec[j]){
       vec=c(vec,colorvec[j])
     }
    }
  }
  return(vec)
}

```

``{r icons, echo=F}
icons=iconList(
  Outpost = makeIcon("BookdownData/Marker/Outpost.png","", 20, 20),
  Big City = makeIcon("BookdownData/Marker/BigCity.png","", 20, 20),
  City = makeIcon("BookdownData/Marker/City.png","", 20, 20),
  Village = makeIcon("BookdownData/Marker/Village.png","", 20, 20),
  Farm = makeIcon("BookdownData/Marker/Farm.png","", 20, 20),
  Militia City = makeIcon("BookdownData/Marker/MilitiaCity.png","", 20, 20),
  Mine City = makeIcon("BookdownData/Marker/Mine City.png","", 20, 20),
  Nature = makeIcon("BookdownData/Marker/Nature.png","", 20, 20),
  Ruin = makeIcon("BookdownData/Marker/Ruine.png","", 20, 20),
  Battle = makeIcon("BookdownData/Marker/Battle.png","", 20, 20),
  Landmark= makeIcon("BookdownData/Marker/Landmark.png","", 20, 20)
)
```

```{r , echo=FALSE, fig.width=8,fig.height=6}
rgvec=c("black", "red", "orange", "green", "blue")

responsiveness = "<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\'"

w <- function()
  with(knitr::opts_current$get(c("fig.width", "dpi", "fig.retina")),
       fig.width * dpi / fig.retina)
h <- function()
  with(knitr::opts_current$get(c("fig.height", "dpi", "fig.retina")),
       fig.height * dpi / fig.retina)


m <- leaflet(width = w(), height = h()) %>%
  addTiles(options = providerTileOptions(minZoom = 4, maxZoom = 8)) %>% # Add default OpenStreetMap map tiles
  setView(lng = 0, lat = 0, 4) %>%
  htmlwidgets::onRender(
    "
      function(el, x) {
        console.log(this);
        var myMap = this;
        var imageUrl = 'BackGroundPastel.png';
        var imageBounds = [[-85,-460], [85, 460]];

        L.imageOverlay(imageUrl, imageBounds).addTo(myMap);
        
        console.log(this);
        var myMap = this;
        var imageUrl = 'OrbisAstea.jpg';
        var imageBounds = [[0,0], [30.72, 40.96]];

        L.imageOverlay(imageUrl, imageBounds).addTo(myMap);
      }
      "
  ) %>%
  
  # add the javascript for responsivness
  htmlwidgets::onRender(paste0("
    function(el, x) {
      $('head').append(",responsiveness,");
    }")) %>%
  
  setMaxBounds(
    lng1 = -3,
    lat1 = -3,
    lng2 = 43,
    lat2 = 33
  ) %>%
  
  
  addMarkers(
    data = dfCities,
    ~ Long,
    ~ Lat,
    popup = paste(
      "<center><p style='color:#663300'>",
      "Name: ",
      dfCities$Name,
      " <br>Population: ",
      dfCities$Population,
      " <br>Region: ",
      '<a href =',
      dfCities$LinkRegion,
      ">",
      dfCities$Region ,
      '</a>',
      " <br>Ruling Faction: ",
      '<a href =',
      dfCities$LinkFaction,
      ">",
      dfCities$`RulingFaction` ,
      '</a>',
      "</center></p>"
    ),
    label = ~dfCities$Name,
    labelOptions = labelOptions(noHide=F, textOnly = T, textsize = 0),
    group = "major cities",
    icon = ~icons[Icons]
  ) %>%
  
    addMarkers(
    data = dfCity,
    ~Long,
    ~ Lat,
    popup = paste(
      "<center><p style='color:#663300'>",
      "Name: ",
      dfCity$Name,
      " <br>Population: ",
      dfCity$Population,
      " <br>Region: ",
      '<a href =',
      dfCity$LinkRegion,
      ">",
      dfCity$Region ,
      '</a>',
      " <br>Ruling Faction: ",
      '<a href =',
      dfCity$LinkFaction,
      ">",
      dfCity$`RulingFaction` ,
      '</a>',
      "</center></p>"
    ),
    group = "cities",
    label = ~dfCity$Name,
    labelOptions = labelOptions(noHide=F, textOnly = T, textsize = 0),
    icon = ~icons[Icons]
  ) %>%
  
      addMarkers(
    data = dfSmall,
    ~Long,
    ~ Lat,
    popup = paste(
      "<center><p style='color:#663300'>",
      "Name: ",
      dfSmall$Name,
      " <br>Population: ",
      dfKlein$Population,
      ", <br>Region: ",
      '<a href =',
      dfKlein$LinkRegion,
      ">",
      dfSmall$Region ,
      '</a>',
      " <br>Ruling Faction: ",
      '<a href =',
      dfSmall$LinkFaction,
      ">",
      dfSmall$`RulingFaction` ,
      '</a>',
      "</center></p>"
    ),
    group = "Small Places"
    label = ~dfSmall$Name,
    labelOptions = labelOptions(noHide=F, textOnly = T, textsize = 0),
    icon = ~icons[Icons]
  ) %>%
  
        addMarkers(
    data = dfMiliz,
    ~ Long,
    ~ Lat,
    popup = paste(
      "<center><p style='color:#663300'>",
      "Name: ",
      dfMilitia$Name,
      ", <br>Population: ",
      dfMiliz$Population,
      " <br>Region: ",
      '<a href =',
      dfMiliz$LinkRegion,
      ">",
      dfMiliz$Region ,
      '</a>',
      " <br>Ruling Faction: ",
      '<a href =',
      dfMiliz$LinkFaction,
      ">",
      dfMiliz$`RulingFaction` ,
      '</a>',
      "</center></p>"
    ),
    group = "Military",
    label = ~dfMilitia$Name,
    labelOptions = labelOptions(noHide=F, textOnly = T, textsize = 0),
    icon = ~icons[Icons]
  ) %>%
  
    addMarkers(
    data = dfNature,
    ~ Long,
    ~ Lat,
    popup = paste(
      "<center><p style='color:#663300'>",
      "Name: ",
      dfNature$Name,
      " <br>Region: ",
      '<a href =',
      dfNature$LinkRegion,
      ">",
      dfNature$Region ,
      '</a>',
      " <br>Ruling Faction: ",
      '<a href =',
      dfNature$LinkFaction,
      ">",
      dfNature$`RulingFaction` ,
      '</a>',
      "</center></p>"
    ),
    group = "sights",
    label = ~dfNature$Name,
    labelOptions = labelOptions(noHide=F, textOnly = T, textsize = 0),
    icon = ~icons[Icons]
  ) %>%
  
  addMarkers(
    data = dfRuins,
    ~ Long,
    ~ Lat,
    popup = paste(
      "<center><p style='color:#663300'>",
      "Name: ",
      dfRuins$Name,
      " <br>Population: ",
      dfRuins$Population,
      " <br>Region: ",
      '<a href =',
      dfRuins$LinkRegion,
      ">",
      dfRuins$Region ,
      '</a>',
      " <br>Ruling Faction: ",
      '<a href =',
      dfRuins$LinkFaction,
      ">",
      'dfRuins$`RulingFaction` ,
      '</a>',
      "</center></p>"
    ),
    group = "Ruins",
    label = ~dfRuins$Name,
    labelOptions = labelOptions(noHide=F, textOnly = T, textsize = 0),
    icon = ~icons[Icons]
  ) %>%
  
  addPolygons(
    data = PolitPolygons,
    color = colvec,
    dashArray = "3",
    fillColor = colvec,
    group = "large empires",
    fillOpacity = 0.2,
    highlight = highlightOptions(
    weight = 5,
    color = "#666",
    dashArray = "",
    fillOpacity = 0.5,
    bringToFront = TRUE,
    ),
    label = PolitLabels
    
  ) %>%
  
  addPolygons(
    data = RegionPolygons,
    group = "RegionOverview",
    #color = "black",
    dashArray = "5",
    fillColor = givecols(RegionPolygonsData$Security,c("Very Weak", "Weak", "Medium", "Strong", "Very Strong"),rgvec),
    weight = 1,
    opacity = 1,
    color = "white",
    fillOpacity = 0.2,
    highlight = highlightOptions(
    weight = 5,
    color = "#666",
    dashArray = "",
    fillOpacity = 0.5,
    bringToFront = TRUE,
    ),
    label = RegionsLabels
    ) %>%
  
  addPolygons(
    data = RegionPolygons,
    group = "religion",
    #color = "black",
    dashArray = "5",
    fillColor = givecols(RegionPolygonsData$RelTolerance,c("Low", "Medium", "High"),c("red", "orange", "green")),
    weight = 1,
    opacity = 1,
    color = "white",
    fillOpacity = 0.2,
    highlight = highlightOptions(
      weight = 5,
      color = "#666",
      dashArray = "",
      fillOpacity = 0.5,
      bringToFront = TRUE,
    ),
    label = ReliLabels
  ) %>%
  addPolygons(
    data = RegionPolygons,
    group = "Economy",
    dashArray = "5",
    fillColor = givecols(RegionPolygonsData$currency,c("Reik", "Rahs", "Crowns"),c("red", "blue", "orange")),
    weight = 1,
    opacity = 1,
    color = "white",
    fillOpacity = 0.2,
    highlight = highlightOptions(
      weight = 5,
      color = "#666",
      dashArray = "",
      fillOpacity = 0.5,
      bringToFront = TRUE,
    ),
    label = EconLabels
  ) %>%
  
  addMeasure(
    position = "bottomleft",
    primaryLengthUnit = "kilometers",
    primaryAreaUnit = "sqmeters",
    localization="en"
  ) %>%
  
  addLegend(
    "topleft",
    colors = colvec,
    labels = c(
      "empire",
      "empire occupied",
      "Rah Kari",
      "Silva Nacia",
      "Volcano Dwarfs"
    ),
    title = "Great Empires",
    group = "Great Empires",
    opacity = 1
  ) %>%
  
    addLegend(
    "bottomright",
    colors = rgvec,
    labels = c("Very Weak", "Weak", "Medium", "Strong", "Very Strong"),
    title = "Security",
    className = "legend region overview",
    opacity = 1
  ) %>%
  
    addLegend(
    "bottomright",
    colors = c("red", "blue", "orange"),
    labels = c("reik", "rahs", "crowns"),
    title = "currency",
    className = "legend economy",
    opacity = 1
  ) %>%
  
  addLegend(
    "bottomright",
    colors = c("red", "orange", "green"),
    labels = c("Low", "Medium", "High"),
    title = "Religious Tolerance",
    className = "legend Religion",
    opacity = 1
  ) %>%
  
  addLayersControl(
    baseGroups = c("Nothing", "Region overview", "Religion", "Economy"),
    overlayGroups = c("Major Cities", "Cities", "Military", "Landmarks", "Small Places", "Ruins", "Major Empires"),
    options = layersControlOptions(collapsed = T)
  ) %>%

  hideGroup(group = c("Great Empires")) %>%
  
  addFullscreenControl(position="bottomright") %>%
  addSearchFeatures(targetGroups=c("Major Cities", "Cities", "Military", "Landmarks", "Small Places", "Ruins"),
                    options = searchFeaturesOptions( zoom=12, openPopup = TRUE, firstTipSubmit = TRUE, autoCollapse = TRUE, hideMarkerOnCollapse = TRUE)) %>%
  addDrawToolbar() %>%
  htmlwidgets::onRender("
      function(el, x) {
         var updateLegend = function () {
            var selectedGroup = document.querySelectorAll('input:checked')[0].nextSibling.innerText.substr(1);
            var selectedClass = selectedGroup.replace(' ', '');
            document.querySelectorAll('.legend').forEach(a => a.hidden=true);
            document.querySelectorAll('.legend').forEach(l => {
               if (l.classList.contains(selectedClass)) l.hidden=false;
            });
         };
         updateLegend();
         this.on('baselayerchange', el => updateLegend());
      }"
  )
```

```{r}
m
```

``{r functiondump}
getTierTable = function(tier, path="container/data/animals.xlsx"){
  df= read_xlsx(path, sheet= tier)
  
  df = df %>% select(attributeName, attribute, parthealth, value)
  
  df2= data.frame(name= c(df$AttributeName, df$Parthealth),
                  value= c(df$Attribute, df$Value)) %>%
    filter(!is.na(name))
  
  rownames(df2) = df2$name
  
  givbak= c("Str",
            "Agi"
            "Cha"
            "Phy",
            "int",
            "inst",
            "health",
            "endurance",
            "mount multyplier",
            "payload",
            "Range of motion/turn",
            "Required skill riding",
            "TameValue",
            "Training Value",
            "Care Intensity",
            "Price Empire",
            "Price Rah Kari")
  
  df= df2[givbak,]
  rownames(df)= 1:nrow(df)
  
  df = df %>% mutate(animal=animal) %>%
    relocate(animal,name,value) %>%
    rename(feature=name,value=value)
  
  tab= reactable(df,groupBy = "animal",
            columns = list(
              
              Animal = colDef(
                grouped = JS("function(cellInfo) {
                            return cellInfo.value
                          }")
                
              )
            ), bordered = F,
            highlight = T, showPageSizeOptions = F,
            defaultPageSize = 17,
            theme= overallThemeReactable,
            defaultColDef = colDef(
              align = "center"
            ), outlined = T,
            striped=T)
  
  return(tab)
}

getHolidays = function(regio){
  dfrR = RegionPolygonsData %>% select(name,realm) %>%
    mutate(realm = str_split(realm, ",")) %>% unnest(realm) %>%
    mutate(realm = str_trim(realm)) %>% filter(name == regio) %>% select(realm)
  realm=dfrR$realm
  
  df = holidaydf %>%
    unnest(relevance) %>% mutate(relevance = str_trim(relevance)) %>%
    filter(relevance %in% c(regio, rich)) %>%
    distinct(name, .keep_all = T) %>%
    mutate(type = factor(ifelse(relevance == regio, "Regional <br>holiday", relevance),
                        levels = c("Regional <br>holiday",rich))) %>%
    select(relevance) %>%
    arrange(type) %>%
    replace_na(list(description=""))
  
  if (nrow(df) > 0){
    df= knitr::kable(df, align = c(rep("c",4)))
    return(df)
  } else{
    return()
  }
}


```

```{r}
bookdownallgdatapath="BookdownData/BookdownAllaroundData.xlsx"
allgdatapath="Container/Data/AllaroundDataStorage.xlsx"

Feiertagdf = read_excel(bookdownallgdatapfad,sheet="Feiertage")
Feiertagdf$Relevance = str_split(Feiertagdf$Relevance, ",")

```
